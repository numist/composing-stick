var infScrLoadingFeedback='<p>loadingâ€¦</p>';

var infScrStates={idle:0,loading:1,success:2};var infScrState=infScrStates.idle;var infScrUrlBasePage=null;function infScrExecute(){function updatepath(path){if(infScrUrlBasePage==null){regexp=/\/pages?\/([0-9]+)-?[0-9]*\/?$/;if(regexp.test(window.location.href)){nextPage=regexp.exec(window.location.href);infScrUrlBasePage=nextPage[1];}else{nextPage=regexp.exec(path);infScrUrlBasePage=nextPage[1]-1;}}
path=path.replace("page/","pages/"+infScrUrlBasePage+"-");window.history.replaceState(null,null,path);}
function scriptmatch(script,haystack){for(i=0;i<haystack.length;i++){if($(script).html()==$(haystack[i]).html()){return true;}}
return false;}
if(infScrState==infScrStates.idle&&$(document).height()<$(document).scrollTop()+(2*$(window).height()))
{infScrState=infScrStates.loading;moreNode=$('article#more').last();moreURL=moreNode.find('a').last().attr("href");if(moreURL.length>0&&moreNode.css('display')!='none'&&!!(window.history&&history.replaceState))
{$.ajax({type:'GET',url:moreURL,beforeSend:function(){moreNode.clone().empty().insertBefore(moreNode).append(infScrLoadingFeedback);moreNode.hide();},success:function(data){var filteredData=$(data).find("article");if(filteredData.length>0){infScrState=infScrStates.success;filteredData.insertAfter(moreNode);$(data).filter("script").each(function(index,item){if(!scriptmatch(item,$(document).find("script"))){var element=document.createElement("script");element.charset="utf-8";element.type="text/javascript";if(item.src){element.src=item.src;}else if($(item).html().length){element.innerHTML=$(item).html();}
document.body.appendChild(element);}});updatepath(moreURL)}},complete:function(jqXHR,textStatus){moreNode.prev().remove();if(infScrState!=infScrStates.success){moreNode.show();}
infScrState=infScrStates.idle;},dataType:"html"});}}}
$(document).ready(function(){$(window).scroll(function(){$.doTimeout('scroll',200,infScrExecute);});});